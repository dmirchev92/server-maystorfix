(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[792],{4687:function(e,s,t){Promise.resolve().then(t.bind(t,212))},212:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return o}});var a=t(7437),r=t(9376),l=t(2265),n=t(4362),c=t(9743),d=t(1837),i=t(1819);function o(){let e=(0,r.useParams)(),s=(0,r.useRouter)(),{user:t,isAuthenticated:o}=(0,n.a)(),[u,m]=(0,l.useState)(null),[x,h]=(0,l.useState)(!0),[b,p]=(0,l.useState)(null),f=e.caseId;(0,l.useEffect)(()=>{if(!o){s.push("/auth/login?redirect=/survey/".concat(f));return}j()},[o,f]);let j=async()=>{try{var e;h(!0);let s=await d.x.getCase(f);if(null===(e=s.data)||void 0===e?void 0:e.success){let e=s.data.data;if(e.customer_id!==(null==t?void 0:t.id)){p("Нямате достъп до тази заявка");return}if("completed"!==e.status){p("Тази заявка все още не е завършена");return}m(e)}else p("Заявката не е намерена")}catch(e){console.error("Error fetching case details:",e),p("Възникна грешка при зареждането на заявката")}finally{h(!1)}},g=async()=>{s.push("/dashboard?survey=completed")};return x?(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-slate-600 mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-slate-600",children:"Зареждане..."})]})}):b?(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-6xl mb-4",children:"❌"}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Грешка"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:b}),(0,a.jsx)("button",{onClick:()=>s.push("/dashboard"),className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700",children:"Към таблото"})]})}):u?(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100",children:[(0,a.jsx)(i.Header,{}),(0,a.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,a.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"\uD83C\uDF1F Оценете получената услуга"}),(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[(0,a.jsx)("h2",{className:"font-semibold text-blue-900 mb-2",children:"Детайли за заявката:"}),(0,a.jsxs)("p",{className:"text-blue-800",children:[(0,a.jsx)("strong",{children:"Услуга:"})," ",u.description]}),(0,a.jsxs)("p",{className:"text-blue-800",children:[(0,a.jsx)("strong",{children:"Изпълнител:"})," ",u.provider_name]}),(0,a.jsxs)("p",{className:"text-blue-800",children:[(0,a.jsx)("strong",{children:"Завършена на:"})," ",new Date(u.completed_at).toLocaleDateString("bg-BG")]})]}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"Вашето мнение е важно за нас и помага на други клиенти да направят правилния избор. Моля отделете няколко минути да оцените получената услуга."})]}),(0,a.jsx)(c.Z,{isOpen:!0,onClose:()=>{s.push("/dashboard")},caseId:u.id,providerId:u.provider_id,providerName:u.provider_name,onSubmitSuccess:g})]})})]}):null}}},function(e){e.O(0,[301,648,137,924,819,743,971,117,744],function(){return e(e.s=4687)}),_N_E=e.O()}]);