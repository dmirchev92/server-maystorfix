(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{2836:function(e,t,s){Promise.resolve().then(s.bind(s,3120))},3120:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return m}});var n=s(7437),a=s(2265),l=s(4362),o=s(9376),r=s(7648),i=s(1837),d=s(757),c=s(1819);function m(){var e,t,s,m,h,p,v;let{user:g,isAuthenticated:b,isLoading:f,logout:j}=(0,l.a)(),N=(0,o.useRouter)(),[y,w]=(0,a.useState)(null),[D,C]=(0,a.useState)({isOpen:!1,method:"",transactions:[]}),[B,k]=(0,a.useState)({isOpen:!1,month:"",transactions:[]}),[F,I]=(0,a.useState)(!1),[G,_]=(0,a.useState)(""),[E,S]=(0,a.useState)(!1),[M,O]=(0,a.useState)([]),[R,L]=(0,a.useState)(new Date().getFullYear());(0,a.useEffect)(()=>{if(!f&&!b){N.push("/auth/login");return}if(!f&&b&&g&&"service_provider"!==g.role&&"tradesperson"!==g.role){console.log(" User is not a service provider, redirecting to home. Role:",g.role),N.push("/");return}},[b,f,g,N]),(0,a.useEffect)(()=>{b&&g&&T()},[b,null==g?void 0:g.id]),(0,a.useEffect)(()=>{b&&g&&R&&Y()},[b,null==g?void 0:g.id,R]);let T=async()=>{try{if((null==g?void 0:g.role)==="tradesperson"||(null==g?void 0:g.role)==="service_provider"){var e;let t=await i.x.getIncomeYears(g.id);if(null===(e=t.data)||void 0===e?void 0:e.success){let e=t.data.data||[];O(e);let s=new Date().getFullYear();e.includes(s)?L(s):e.length>0&&L(e[e.length-1])}}}catch(e){console.error("Error fetching available years:",e)}},Y=async()=>{try{if((null==g?void 0:g.role)==="tradesperson"||(null==g?void 0:g.role)==="service_provider"){var e;let t="".concat(R,"-01-01"),s="".concat(R,"-12-31"),n=await i.x.getIncomeStats(g.id,t,s);if(null===(e=n.data)||void 0===e?void 0:e.success){w(n.data.data);let e=new Date().getMonth();11===e&&I(!0)}}}catch(e){console.error("Error fetching income stats:",e)}},A=()=>{var e,t,s,n,a,l,o,r;if(!y)return;let i="data:text/csv;charset=utf-8,%EF%BB%BF";i+="=== ОБЩ ОТЧЕТ ЗА ПРИХОДИ ===\\n\\n"+"Общо приходи:,".concat(null===(t=y.summary)||void 0===t?void 0:null===(e=t.totalIncome)||void 0===e?void 0:e.toFixed(2)," BGN\\n")+"Брой заявки:,".concat(null===(s=y.summary)||void 0===s?void 0:s.incomeCount,"\\n")+"Средно на заявка:,".concat(null===(a=y.summary)||void 0===a?void 0:null===(n=a.averageIncome)||void 0===n?void 0:n.toFixed(2)," BGN\\n\\n")+"=== МЕСЕЧНА РАЗБИВКА ===\\n\\n",null===(l=y.monthlyIncome)||void 0===l||l.forEach(e=>{var t,s;let n=new Date(e.month+"-01").toLocaleDateString("bg-BG",{month:"long",year:"numeric"});i+="--- ".concat(n," ---\\n")+"Общо приходи:,".concat(null===(t=e.total)||void 0===t?void 0:t.toFixed(2)," BGN\\n")+"Брой заявки:,".concat(e.count,"\\n")+"Средно на заявка:,".concat(null===(s=e.average)||void 0===s?void 0:s.toFixed(2)," BGN\\n\\n")}),i+="=== ОБОБЩЕНА ТАБЛИЦА ===\\nМесец,Общо приходи (BGN),Брой заявки,Средно (BGN)\\n",null===(o=y.monthlyIncome)||void 0===o||o.forEach(e=>{var t,s;let n=new Date(e.month+"-01").toLocaleDateString("bg-BG",{month:"long",year:"numeric"});i+="".concat(n,",").concat(null===(t=e.total)||void 0===t?void 0:t.toFixed(2),",").concat(e.count,",").concat(null===(s=e.average)||void 0===s?void 0:s.toFixed(2),"\\n")}),i+="\\n=== ПО МЕТОД НА ПЛАЩАНЕ ===\\nМетод,Общо приходи (BGN),Брой заявки,Средно (BGN)\\n",null===(r=y.paymentMethods)||void 0===r||r.forEach(e=>{var t;let s=e.count>0?(e.total/e.count).toFixed(2):"0.00";i+="".concat(e.method,",").concat(null===(t=e.total)||void 0===t?void 0:t.toFixed(2),",").concat(e.count,",").concat(s,"\\n")});let d=encodeURI(i),c=document.createElement("a");c.setAttribute("href",d),c.setAttribute("download","income_report_".concat(R,".csv")),document.body.appendChild(c),c.click(),document.body.removeChild(c)},U=async e=>{try{var t;let s=await i.x.getIncomeTransactionsByMethod(g.id,e);(null===(t=s.data)||void 0===t?void 0:t.success)&&C({isOpen:!0,method:e,transactions:s.data.data||[]})}catch(e){console.error("Error fetching transactions:",e),alert("Възникна грешка при зареждането на транзакциите")}},z=async e=>{try{var t;let s=await i.x.getIncomeTransactionsByMonth(g.id,e);(null===(t=s.data)||void 0===t?void 0:t.success)&&k({isOpen:!0,month:e,transactions:s.data.data||[]})}catch(e){console.error("Error fetching month transactions:",e),alert("Възникна грешка при зареждането на транзакциите")}};return f?(0,n.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-indigo-900 flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-white/30 mx-auto"}),(0,n.jsx)("p",{className:"mt-4 text-slate-200",children:"Табло????..."})]})}):b&&g?(0,n.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-indigo-900",children:[(0,n.jsx)(c.Header,{}),(0,n.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,n.jsxs)("div",{className:"mb-8",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-white mb-4",children:"Табло"}),(0,n.jsxs)("div",{className:"flex gap-2 border-b border-slate-700",children:[(0,n.jsx)(r.default,{href:"/dashboard",className:"px-6 py-3 font-medium text-white border-b-2 border-green-500 bg-slate-800/50",children:"Преглед"}),(0,n.jsx)(r.default,{href:"/dashboard/cases",className:"px-6 py-3 font-medium text-slate-400 hover:text-slate-200 hover:bg-slate-800/30",children:"Заявки"})]})]}),y&&(0,n.jsxs)(d.Zb,{className:"mb-6 bg-gradient-to-br from-slate-800/90 to-slate-900/90 backdrop-blur-sm border-2 border-green-500/30 shadow-xl",children:[(0,n.jsx)(d.Ol,{children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)(d.ll,{className:"flex items-center gap-2 text-white",children:[(0,n.jsx)("span",{className:"text-2xl",children:"\uD83D\uDCB0"}),(0,n.jsx)("span",{children:"Приходи"})]}),(0,n.jsxs)("button",{onClick:A,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors flex items-center gap-2 text-sm font-medium",children:[(0,n.jsx)("span",{children:"\uD83D\uDCE5"}),(0,n.jsx)("span",{children:"Изтегли отчет"})]})]})}),(0,n.jsxs)(d.aY,{children:[F&&(0,n.jsx)("div",{className:"mb-6 bg-gradient-to-r from-orange-500/20 to-red-500/20 border-2 border-orange-400/50 rounded-lg p-4",children:(0,n.jsxs)("div",{className:"flex items-start gap-3",children:[(0,n.jsx)("span",{className:"text-2xl",children:"⚠️"}),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("h4",{className:"text-orange-300 font-bold mb-1",children:"Внимание: Край на годината"}),(0,n.jsx)("p",{className:"text-slate-300 text-sm mb-3",children:"Всички данни за приходите ще бъдат изтрити на 1 януари. Моля изтеглете вашия годишен отчет преди края на декември."}),(0,n.jsx)("button",{onClick:A,className:"px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded-lg transition-colors text-sm font-medium",children:"\uD83D\uDCE5 Изтегли годишен отчет сега"})]})]})}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[y.monthlyIncome&&y.monthlyIncome.length>0&&(0,n.jsxs)("div",{className:"bg-gradient-to-br from-purple-500/20 to-pink-500/20 p-4 rounded-lg border border-purple-400/30",children:[(0,n.jsx)("div",{className:"text-sm text-slate-300 mb-2",children:"Избран месец"}),(0,n.jsx)("select",{value:G||(null===(e=y.monthlyIncome[0])||void 0===e?void 0:e.month),onChange:e=>_(e.target.value),className:"w-full mb-3 px-2 py-1 bg-slate-700 text-slate-200 rounded border border-purple-400/30 text-xs focus:outline-none focus:border-purple-400",children:y.monthlyIncome.map(e=>(0,n.jsx)("option",{value:e.month,children:new Date(e.month+"-01").toLocaleDateString("bg-BG",{month:"long",year:"numeric"})},e.month))}),(()=>{var e,t,s;let a=y.monthlyIncome.find(e=>{var t;return e.month===(G||(null===(t=y.monthlyIncome[0])||void 0===t?void 0:t.month))});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"text-2xl font-bold text-purple-400",children:[(null==a?void 0:null===(e=a.total)||void 0===e?void 0:e.toFixed(2))||"0.00"," ",(null===(t=y.summary)||void 0===t?void 0:t.currency)||"BGN"]}),(0,n.jsxs)("div",{className:"text-xs text-slate-400 mt-1",children:[(null==a?void 0:a.count)||0," заявки • Средно: ",(null==a?void 0:null===(s=a.average)||void 0===s?void 0:s.toFixed(2))||"0.00"," BGN"]})]})})()]}),(0,n.jsxs)("div",{className:"bg-gradient-to-br from-green-500/20 to-emerald-500/20 p-4 rounded-lg border border-green-400/30",children:[(0,n.jsx)("div",{className:"text-sm text-slate-300 mb-2",children:"Общо приходи"}),M.length>0&&(0,n.jsx)("select",{value:R,onChange:e=>L(parseInt(e.target.value)),className:"w-full mb-3 px-2 py-1 bg-slate-700 text-slate-200 rounded border border-green-400/30 text-xs focus:outline-none focus:border-green-400",children:M.map(e=>(0,n.jsxs)("option",{value:e,children:[e," г."]},e))}),(0,n.jsxs)("div",{className:"text-2xl font-bold text-green-400",children:[(null===(s=y.summary)||void 0===s?void 0:null===(t=s.totalIncome)||void 0===t?void 0:t.toFixed(2))||"0.00"," ",(null===(m=y.summary)||void 0===m?void 0:m.currency)||"BGN"]}),(0,n.jsxs)("div",{className:"text-xs text-slate-400 mt-1",children:[(null===(h=y.summary)||void 0===h?void 0:h.incomeCount)||0," заявки • Средно: ",(null===(v=y.summary)||void 0===v?void 0:null===(p=v.averageIncome)||void 0===p?void 0:p.toFixed(2))||"0.00"," BGN"]})]})]}),y.monthlyIncome&&y.monthlyIncome.length>0&&(0,n.jsxs)("div",{className:"mt-4",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,n.jsx)("h4",{className:"text-sm font-medium text-slate-300",children:"Месечна разбивка"}),y.monthlyIncome.length>1&&(0,n.jsxs)("select",{value:E?"all":"current",onChange:e=>S("all"===e.target.value),className:"px-3 py-1 bg-slate-700 text-slate-200 rounded border border-slate-600 text-xs focus:outline-none focus:border-green-500",children:[(0,n.jsx)("option",{value:"current",children:"Текущ месец"}),(0,n.jsxs)("option",{value:"all",children:["Всички месеци (",y.monthlyIncome.length,")"]})]})]}),(0,n.jsx)("div",{className:"space-y-2",children:(E?y.monthlyIncome.slice(0,12):y.monthlyIncome.slice(0,1)).map(e=>{var t;return(0,n.jsxs)("button",{onClick:()=>z(e.month),className:"w-full flex items-center justify-between p-3 bg-slate-800/50 hover:bg-slate-700/50 rounded-lg border border-slate-700/50 hover:border-green-500/50 transition-all cursor-pointer group",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("span",{className:"text-sm font-medium text-slate-300 group-hover:text-green-300 transition-colors",children:new Date(e.month+"-01").toLocaleDateString("bg-BG",{month:"long",year:"numeric"})}),(0,n.jsxs)("span",{className:"text-xs text-slate-400 group-hover:text-slate-300 transition-colors",children:[e.count," заявки"]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsxs)("span",{className:"text-sm font-bold text-green-400 group-hover:text-green-300 transition-colors",children:[null===(t=e.total)||void 0===t?void 0:t.toFixed(2)," BGN"]}),(0,n.jsx)("span",{className:"text-xs text-green-400 opacity-0 group-hover:opacity-100 transition-opacity",children:"\uD83D\uDC46"})]})]},e.month)})})]}),y.paymentMethods&&y.paymentMethods.length>0&&(0,n.jsxs)("div",{className:"mt-4",children:[(0,n.jsx)("h4",{className:"text-sm font-medium text-slate-300 mb-3",children:"По метод на плащане (кликнете за детайли)"}),(0,n.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:(()=>{let e={cash:"\uD83D\uDCB5 Кеш",card:"\uD83D\uDCB3 Картово плащане",bank_transfer:"\uD83C\uDFE6 Банков път",online:"\uD83C\uDF10 Revolut",other:"\uD83D\uDCDD Друго"};return[...y.paymentMethods].sort((e,t)=>t.total-e.total).map(t=>{var s;return(0,n.jsxs)("button",{onClick:()=>U(t.method),className:"p-3 bg-slate-800/50 hover:bg-slate-700/50 rounded-lg text-center border border-slate-700/50 hover:border-green-500/50 transition-all cursor-pointer group",children:[(0,n.jsx)("div",{className:"text-xs text-slate-400 group-hover:text-green-400 mb-1 transition-colors",children:e[t.method]||t.method}),(0,n.jsxs)("div",{className:"text-sm font-bold text-slate-200 group-hover:text-green-300 transition-colors",children:[null===(s=t.total)||void 0===s?void 0:s.toFixed(2)," BGN"]}),(0,n.jsxs)("div",{className:"text-xs text-slate-500 group-hover:text-slate-400 transition-colors",children:[t.count," заявки"]}),(0,n.jsx)("div",{className:"text-xs text-green-400 opacity-0 group-hover:opacity-100 transition-opacity mt-1",children:"\uD83D\uDC46 Виж детайли"})]},t.method)})})()})]})]})]})]}),D.isOpen&&(0,n.jsx)(u,{method:D.method,transactions:D.transactions,onClose:()=>C({isOpen:!1,method:"",transactions:[]}),onTransactionUpdated:()=>{Y(),C({isOpen:!1,method:"",transactions:[]})}}),B.isOpen&&(0,n.jsx)(x,{month:B.month,transactions:B.transactions,onClose:()=>k({isOpen:!1,month:"",transactions:[]}),onTransactionUpdated:()=>{Y(),k({isOpen:!1,month:"",transactions:[]})}})]}):null}function u(e){let{method:t,transactions:s,onClose:l,onTransactionUpdated:o}=e,[r,d]=(0,a.useState)(null),[c,m]=(0,a.useState)({amount:"",paymentMethod:"",notes:""}),u=e=>{d(e),m({amount:e.amount.toString(),paymentMethod:e.payment_method||"",notes:e.notes||""})},x=async()=>{try{await i.x.updateIncomeTransaction(r.id,{amount:parseFloat(c.amount),paymentMethod:c.paymentMethod,notes:c.notes}),alert("Транзакцията беше обновена успешно!"),d(null),o()}catch(e){console.error("Error updating transaction:",e),alert("Възникна грешка при обновяването")}};return(0,n.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,n.jsxs)("div",{className:"bg-slate-800 rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,n.jsxs)("div",{className:"bg-gradient-to-r from-green-600 to-emerald-600 text-white p-6 rounded-t-lg sticky top-0",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("h2",{className:"text-2xl font-bold",children:["\uD83D\uDCB3 Транзакции: ",t]}),(0,n.jsx)("button",{onClick:l,className:"text-white/80 hover:text-white text-2xl",children:"✕"})]}),(0,n.jsxs)("p",{className:"text-green-100 mt-1",children:[s.length," транзакции"]})]}),(0,n.jsxs)("div",{className:"p-6 space-y-4",children:[s.map(e=>(0,n.jsx)("div",{className:"bg-slate-700/50 border border-slate-600 rounded-lg p-4",children:(null==r?void 0:r.id)===e.id?(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm text-slate-300 mb-1",children:"Сума (BGN)"}),(0,n.jsx)("input",{type:"number",step:"0.01",value:c.amount,onChange:e=>m({...c,amount:e.target.value}),className:"w-full px-3 py-2 bg-slate-600 text-white rounded border border-slate-500 focus:border-green-500 focus:outline-none"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm text-slate-300 mb-1",children:"Метод на плащане"}),(0,n.jsxs)("select",{value:c.paymentMethod,onChange:e=>m({...c,paymentMethod:e.target.value}),className:"w-full px-3 py-2 bg-slate-600 text-white rounded border border-slate-500 focus:border-green-500 focus:outline-none",children:[(0,n.jsx)("option",{value:"cash",children:"\uD83D\uDCB5 Кеш"}),(0,n.jsx)("option",{value:"card",children:"\uD83D\uDCB3 Картово плащане"}),(0,n.jsx)("option",{value:"bank_transfer",children:"\uD83C\uDFE6 Банков път"}),(0,n.jsx)("option",{value:"online",children:"\uD83C\uDF10 Revolut"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm text-slate-300 mb-1",children:"Бележки"}),(0,n.jsx)("input",{type:"text",value:c.notes,onChange:e=>m({...c,notes:e.target.value}),className:"w-full px-3 py-2 bg-slate-600 text-white rounded border border-slate-500 focus:border-green-500 focus:outline-none",placeholder:"Допълнителни бележки..."})]})]}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("button",{onClick:x,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded transition-colors",children:"✅ Запази"}),(0,n.jsx)("button",{onClick:()=>d(null),className:"px-4 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded transition-colors",children:"✕ Отказ"})]})]}):(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsxs)("div",{className:"flex items-center gap-4 mb-2",children:[(0,n.jsxs)("span",{className:"text-2xl font-bold text-green-400",children:[e.amount.toFixed(2)," BGN"]}),(0,n.jsx)("span",{className:"text-sm text-slate-400",children:new Date(e.recorded_at).toLocaleDateString("bg-BG",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"})})]}),e.case_description&&(0,n.jsxs)("p",{className:"text-sm text-slate-300 mb-1",children:["\uD83D\uDCCB ",e.case_description]}),e.notes&&(0,n.jsxs)("p",{className:"text-xs text-slate-400",children:["\uD83D\uDCAC ",e.notes]})]}),(0,n.jsx)("button",{onClick:()=>u(e),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded transition-colors text-sm",children:"✏️ Редактирай"})]})},e.id)),0===s.length&&(0,n.jsx)("div",{className:"text-center py-8 text-slate-400",children:(0,n.jsx)("p",{children:"Няма транзакции за този метод на плащане"})})]})]})})}function x(e){let{month:t,transactions:s,onClose:l,onTransactionUpdated:o}=e,[r,d]=(0,a.useState)(null),[c,m]=(0,a.useState)({amount:"",paymentMethod:"",notes:""}),u=e=>{d(e),m({amount:e.amount.toString(),paymentMethod:e.payment_method||"",notes:e.notes||""})},x=async()=>{try{await i.x.updateIncomeTransaction(r.id,{amount:parseFloat(c.amount),paymentMethod:c.paymentMethod,notes:c.notes}),alert("Транзакцията беше обновена успешно!"),d(null),o()}catch(e){console.error("Error updating transaction:",e),alert("Възникна грешка при обновяването")}},h=new Date(t+"-01").toLocaleDateString("bg-BG",{month:"long",year:"numeric"});return(0,n.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,n.jsxs)("div",{className:"bg-slate-800 rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,n.jsxs)("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 text-white p-6 rounded-t-lg sticky top-0",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("h2",{className:"text-2xl font-bold",children:["\uD83D\uDCC5 ",h]}),(0,n.jsx)("button",{onClick:l,className:"text-white/80 hover:text-white text-2xl",children:"✕"})]}),(0,n.jsxs)("p",{className:"text-purple-100 mt-1",children:[s.length," транзакции"]})]}),(0,n.jsxs)("div",{className:"p-6 space-y-4",children:[s.map(e=>(0,n.jsx)("div",{className:"bg-slate-700/50 border border-slate-600 rounded-lg p-4",children:(null==r?void 0:r.id)===e.id?(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm text-slate-300 mb-1",children:"Сума (BGN)"}),(0,n.jsx)("input",{type:"number",step:"0.01",value:c.amount,onChange:e=>m({...c,amount:e.target.value}),className:"w-full px-3 py-2 bg-slate-600 text-white rounded border border-slate-500 focus:border-green-500 focus:outline-none"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm text-slate-300 mb-1",children:"Метод на плащане"}),(0,n.jsxs)("select",{value:c.paymentMethod,onChange:e=>m({...c,paymentMethod:e.target.value}),className:"w-full px-3 py-2 bg-slate-600 text-white rounded border border-slate-500 focus:border-green-500 focus:outline-none",children:[(0,n.jsx)("option",{value:"cash",children:"\uD83D\uDCB5 Кеш"}),(0,n.jsx)("option",{value:"card",children:"\uD83D\uDCB3 Картово плащане"}),(0,n.jsx)("option",{value:"bank_transfer",children:"\uD83C\uDFE6 Банков път"}),(0,n.jsx)("option",{value:"online",children:"\uD83C\uDF10 Revolut"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm text-slate-300 mb-1",children:"Бележки"}),(0,n.jsx)("input",{type:"text",value:c.notes,onChange:e=>m({...c,notes:e.target.value}),className:"w-full px-3 py-2 bg-slate-600 text-white rounded border border-slate-500 focus:border-green-500 focus:outline-none",placeholder:"Допълнителни бележки..."})]})]}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("button",{onClick:x,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded transition-colors",children:"✅ Запази"}),(0,n.jsx)("button",{onClick:()=>d(null),className:"px-4 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded transition-colors",children:"✕ Отказ"})]})]}):(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsxs)("div",{className:"flex items-center gap-4 mb-2",children:[(0,n.jsxs)("span",{className:"text-2xl font-bold text-green-400",children:[e.amount.toFixed(2)," BGN"]}),(0,n.jsx)("span",{className:"px-2 py-1 bg-blue-500/20 text-blue-300 rounded text-xs",children:e.payment_method||"Неуточнен"}),(0,n.jsx)("span",{className:"text-sm text-slate-400",children:new Date(e.recorded_at).toLocaleDateString("bg-BG",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})})]}),e.case_description&&(0,n.jsxs)("p",{className:"text-sm text-slate-300 mb-1",children:["\uD83D\uDCCB ",e.case_description]}),e.notes&&(0,n.jsxs)("p",{className:"text-xs text-slate-400",children:["\uD83D\uDCAC ",e.notes]})]}),(0,n.jsx)("button",{onClick:()=>u(e),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded transition-colors text-sm",children:"✏️ Редактирай"})]})},e.id)),0===s.length&&(0,n.jsx)("div",{className:"text-center py-8 text-slate-400",children:(0,n.jsx)("p",{children:"Няма транзакции за този месец"})})]})]})})}},757:function(e,t,s){"use strict";s.d(t,{Ol:function(){return r},Zb:function(){return o},aY:function(){return d},ll:function(){return i}});var n=s(7437),a=s(2265),l=s(3448);let o=a.forwardRef((e,t)=>{let{className:s,variant:a="default",padding:o="md",hover:r=!1,children:i,...d}=e;return(0,n.jsx)("div",{className:(0,l.cn)("\n      rounded-xl transition-all duration-300 ease-in-out\n      ".concat(r?"hover:scale-[1.02] hover:shadow-xl cursor-pointer":"","\n    "),{default:"\n        bg-white/10 backdrop-blur-md border border-white/20 shadow-lg\n        hover:shadow-xl hover:bg-white/15\n      ",elevated:"\n        bg-white/10 backdrop-blur-md shadow-xl hover:shadow-2xl\n        border border-white/20 hover:border-white/30\n      ",glass:"\n        bg-white/10 backdrop-blur-md border border-white/20\n        shadow-lg hover:shadow-xl hover:bg-white/20\n      ",gradient:"\n        bg-gradient-to-br from-white/10 to-white/5 backdrop-blur-md\n        border border-white/20 shadow-lg\n        hover:from-white/15 hover:to-white/10 hover:shadow-xl\n      ",outline:"\n        bg-transparent border-2 border-white/30\n        hover:border-white/50 hover:bg-white/10\n      "}[a],{none:"",sm:"p-4",md:"p-6",lg:"p-8",xl:"p-10"}[o],s),ref:t,...d,children:i})});o.displayName="Card";let r=a.forwardRef((e,t)=>{let{className:s,children:a,...o}=e;return(0,n.jsx)("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 pb-4",s),...o,children:a})});r.displayName="CardHeader";let i=a.forwardRef((e,t)=>{let{className:s,children:a,...o}=e;return(0,n.jsx)("h3",{ref:t,className:(0,l.cn)("text-lg font-semibold leading-none tracking-tight text-white",s),...o,children:a})});i.displayName="CardTitle",a.forwardRef((e,t)=>{let{className:s,children:a,...o}=e;return(0,n.jsx)("p",{ref:t,className:(0,l.cn)("text-sm text-slate-300",s),...o,children:a})}).displayName="CardDescription";let d=a.forwardRef((e,t)=>{let{className:s,children:a,...o}=e;return(0,n.jsx)("div",{ref:t,className:(0,l.cn)("",s),...o,children:a})});d.displayName="CardContent",a.forwardRef((e,t)=>{let{className:s,children:a,...o}=e;return(0,n.jsx)("div",{ref:t,className:(0,l.cn)("flex items-center pt-4",s),...o,children:a})}).displayName="CardFooter"}},function(e){e.O(0,[301,648,137,924,819,971,117,744],function(){return e(e.s=2836)}),_N_E=e.O()}]);