(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{8152:function(e,r,a){Promise.resolve().then(a.t.bind(a,9974,23)),Promise.resolve().then(a.t.bind(a,2778,23)),Promise.resolve().then(a.bind(a,2096)),Promise.resolve().then(a.bind(a,1396)),Promise.resolve().then(a.bind(a,6050)),Promise.resolve().then(a.t.bind(a,1067,23))},2096:function(e,r,a){"use strict";a.d(r,{Providers:function(){return z}});var t=a(7437),s=a(8575),n=a(1455),i=a(1837);let o=(0,n.hg)("auth/login",async e=>{let{email:r,password:a}=e;return await i.x.login(r,a)}),l=(0,n.hg)("auth/register",async e=>(await i.x.register(e)).data),d=(0,n.hg)("auth/loadUser",async()=>(await i.x.getProfile()).data),c=(0,n.hg)("auth/logout",async()=>{await i.x.logout()}),u=(0,n.oM)({name:"auth",initialState:{user:null,token:null,isAuthenticated:!1,isLoading:!1,error:null},reducers:{clearError:e=>{e.error=null},setToken:(e,r)=>{e.token=r.payload,e.isAuthenticated=!0}},extraReducers:e=>{e.addCase(o.pending,e=>{e.isLoading=!0,e.error=null}).addCase(o.fulfilled,(e,r)=>{e.isLoading=!1,e.user=r.payload.user,e.token=r.payload.token,e.isAuthenticated=!0,e.error=null}).addCase(o.rejected,(e,r)=>{e.isLoading=!1,e.error=r.error.message||"Login failed"}).addCase(l.pending,e=>{e.isLoading=!0,e.error=null}).addCase(l.fulfilled,(e,r)=>{e.isLoading=!1,e.user=r.payload.user,e.token=r.payload.token,e.isAuthenticated=!0,e.error=null}).addCase(l.rejected,(e,r)=>{e.isLoading=!1,e.error=r.error.message||"Registration failed"}).addCase(d.fulfilled,(e,r)=>{e.user=r.payload,e.isAuthenticated=!0}).addCase(c.fulfilled,e=>{e.user=null,e.token=null,e.isAuthenticated=!1,e.error=null})}}),{clearError:g,setToken:h}=u.actions;var p=u.reducer;let m={providers:[],filters:{serviceType:"",city:"",neighborhood:"",minRating:0,maxPrice:void 0,availability:"any"},isLoading:!1,error:null,totalResults:0,currentPage:1},f=(0,n.hg)("search/providers",async e=>(await i.x.searchProviders(e)).data);(0,n.hg)("search/providerDetails",async e=>(await i.x.getProvider(e)).data);let v=(0,n.oM)({name:"search",initialState:m,reducers:{setFilters:(e,r)=>{e.filters={...e.filters,...r.payload}},clearFilters:e=>{e.filters=m.filters},setPage:(e,r)=>{e.currentPage=r.payload},clearError:e=>{e.error=null}},extraReducers:e=>{e.addCase(f.pending,e=>{e.isLoading=!0,e.error=null}).addCase(f.fulfilled,(e,r)=>{e.isLoading=!1,e.providers=r.payload.providers,e.totalResults=r.payload.totalResults,e.error=null}).addCase(f.rejected,(e,r)=>{e.isLoading=!1,e.error=r.error.message||"Search failed"})}}),{setFilters:x,clearFilters:y,setPage:C,clearError:b}=v.actions;var w=v.reducer;let S=(0,n.hg)("messaging/loadConversations",async()=>(await i.x.getConversations()).data),j=(0,n.hg)("messaging/sendMessage",async e=>(await i.x.sendMessage(e)).data),P=(0,n.oM)({name:"messaging",initialState:{conversations:[],activeConversation:null,isLoading:!1,error:null,unreadCount:0},reducers:{setActiveConversation:(e,r)=>{e.activeConversation=r.payload},addMessage:(e,r)=>{let{conversationId:a,message:t}=r.payload,s=e.conversations.find(e=>e.id===a);if(s){var n;s.messages.push(t),s.lastActivity=t.timestamp,t.senderId!==(null===(n=e.activeConversation)||void 0===n?void 0:n.id)&&(e.unreadCount+=1)}},markAsRead:(e,r)=>{let a=r.payload,t=e.conversations.find(e=>e.id===a);t&&(t.messages.forEach(e=>{e.isRead=!0}),e.unreadCount=Math.max(0,e.unreadCount-1))},clearError:e=>{e.error=null}},extraReducers:e=>{e.addCase(S.pending,e=>{e.isLoading=!0,e.error=null}).addCase(S.fulfilled,(e,r)=>{e.isLoading=!1,e.conversations=r.payload,e.unreadCount=r.payload.reduce((e,r)=>e+r.messages.filter(e=>!e.isRead).length,0),e.error=null}).addCase(S.rejected,(e,r)=>{e.isLoading=!1,e.error=r.error.message||"Failed to load conversations"}).addCase(j.fulfilled,(e,r)=>{e.error=null}).addCase(j.rejected,(e,r)=>{e.error=r.error.message||"Failed to send message"})}}),{setActiveConversation:_,addMessage:k,markAsRead:L,clearError:I}=P.actions;var N=P.reducer;let R=(0,n.xC)({reducer:{auth:p,search:w,messaging:N},middleware:e=>e({serializableCheck:{ignoredActions:["persist/PERSIST"]}})});var E=a(6252),A=a(4362),M=a(2265);let O=(0,M.createContext)({openWithProvider:()=>{},isOpen:!1,setIsOpen:()=>{},activeProviderId:null,activeProviderName:null});function T(e){let{children:r}=e,[a,s]=(0,M.useState)(!1),[n,i]=(0,M.useState)(null),[o,l]=(0,M.useState)(null);return(0,t.jsx)(O.Provider,{value:{openWithProvider:(e,r)=>{i(e),l(r),s(!0)},isOpen:a,setIsOpen:s,activeProviderId:n,activeProviderName:o},children:r})}var F=a(7829);function z(e){let{children:r}=e;return(0,t.jsx)(s.zt,{store:R,children:(0,t.jsx)(A.H,{children:(0,t.jsx)(E.w,{children:(0,t.jsx)(F.a,{children:(0,t.jsx)(T,{children:r})})})})})}},6050:function(e,r,a){"use strict";a.d(r,{default:function(){return i}});var t=a(7437),s=a(2265),n=a(7648);function i(){let[e,r]=(0,s.useState)(!1);return((0,s.useEffect)(()=>{if(!localStorage.getItem("gdpr_consent_shown")){let e=setTimeout(()=>{r(!0)},1e3);return()=>clearTimeout(e)}},[]),e)?(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-end justify-center p-4 gdpr-popup-overlay",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6 gdpr-popup-content",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Защита на личните данни"}),(0,t.jsxs)("p",{className:"text-gray-600 text-sm mb-4",children:["Използваме бисквитки и други технологии за подобряване на вашето изживяване. Като продължите да използвате нашия сайт, вие се съгласявате с нашата"," ",(0,t.jsx)(n.default,{href:"/privacy-policy",className:"text-blue-600 hover:underline",children:"политика за поверителност"}),"."]}),(0,t.jsxs)("div",{className:"flex space-x-3",children:[(0,t.jsx)("button",{onClick:()=>{localStorage.setItem("gdpr_consent_shown","true"),localStorage.setItem("gdpr_consent_accepted","true"),localStorage.setItem("gdpr_consent_date",new Date().toISOString()),r(!1)},className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors",children:"Приемам"}),(0,t.jsx)("button",{onClick:()=>{localStorage.setItem("gdpr_consent_shown","true"),localStorage.setItem("gdpr_consent_accepted","false"),localStorage.setItem("gdpr_consent_date",new Date().toISOString()),r(!1)},className:"flex-1 bg-gray-200 text-gray-800 px-4 py-2 rounded-lg text-sm font-medium hover:bg-gray-300 transition-colors",children:"Отказвам"})]})]})}):null}},2778:function(){},1067:function(){}},function(e){e.O(0,[326,301,648,680,973,924,103,396,971,117,744],function(){return e(e.s=8152)}),_N_E=e.O()}]);