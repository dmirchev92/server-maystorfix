(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[236],{785:function(e,s,t){Promise.resolve().then(t.bind(t,8827))},8827:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return o}});var r=t(7437),l=t(2265),a=t(4362),i=t(9376),d=t(1819),n=t(2834),c=t(1396),x=t(1837);function o(){let{user:e,isAuthenticated:s,isLoading:t}=(0,a.a)(),o=(0,i.useRouter)(),[h,m]=(0,l.useState)(null),[u,b]=(0,l.useState)([]),[j,g]=(0,l.useState)(!0),[p,v]=(0,l.useState)(null);(0,l.useEffect)(()=>{if(console.log("\uD83C\uDFE0 Provider Dashboard - Auth state:",{isAuthenticated:s,isLoading:t,user:null==e?void 0:e.role,userEmail:null==e?void 0:e.email}),t){console.log("⏳ Auth still loading, waiting...");return}if(!s||!e){console.log("❌ Not authenticated, redirecting to login"),o.push("/auth/login");return}if("service_provider"!==e.role&&"tradesperson"!==e.role){console.log("❌ User is not a service provider, redirecting to home"),o.push("/");return}console.log("✅ Service provider authenticated, loading dashboard"),w()},[s,t,e,o]);let f=async s=>{try{await x.x.acceptCase(s,e.id,"".concat(e.firstName," ").concat(e.lastName)),alert("Заявката беше приета успешно!"),w()}catch(e){console.error("Error accepting case:",e),alert("Грешка при приемане на заявката")}},N=async e=>{try{await x.x.updateCaseStatusDirect(e,"completed","Completed successfully"),alert("Заявката беше завършена успешно!"),w()}catch(e){console.error("Error completing case:",e),alert("Грешка при завършване на заявката")}},w=async()=>{try{var s,t,r,l,a,i;g(!0),v(null);let[d,n,c]=await Promise.all([x.x.getCaseStats(e.id),x.x.getCasesWithFilters({providerId:e.id,limit:5}),x.x.getProvider(e.id)]),o=((null===(s=d.data)||void 0===s?void 0:s.data)||{}).statusStats||[],h=(null===(r=n.data)||void 0===r?void 0:null===(t=r.data)||void 0===t?void 0:t.cases)||[],u=(null===(l=c.data)||void 0===l?void 0:l.data)||{},j=o.reduce((e,s)=>e+(s.count||0),0),p=(null===(a=o.find(e=>"wip"===e.status))||void 0===a?void 0:a.count)||0,f=(null===(i=o.find(e=>"completed"===e.status))||void 0===i?void 0:i.count)||0,N={totalCases:j,activeCases:p,completedCases:f,totalRevenue:0,monthlyRevenue:0,averageRating:u.rating||0,totalReviews:u.totalReviews||u.total_reviews||0},w=h.map(e=>({id:e.id,title:e.description||e.service_type||"Без описание",status:"wip"===e.status?"active":e.status,customerName:e.customer_name||"Неизвестен клиент",createdAt:e.created_at,urgency:e.priority||"normal"}));m(N),b(w)}catch(e){console.error("Error loading dashboard data:",e),v("Неуспешно зареждане на данните за таблото")}finally{g(!1)}},y=e=>{switch(e){case"active":return"text-emerald-400 bg-emerald-500/20 border border-emerald-500/30";case"wip":return"text-purple-400 bg-purple-500/20 border border-purple-500/30";case"pending":return"text-amber-400 bg-amber-500/20 border border-amber-500/30";case"accepted":return"text-blue-400 bg-blue-500/20 border border-blue-500/30";case"completed":return"text-green-400 bg-green-500/20 border border-green-500/30";case"declined":return"text-red-400 bg-red-500/20 border border-red-500/30";default:return"text-slate-400 bg-slate-500/20 border border-slate-500/30"}},D=e=>{switch(e){case"active":return"Активна";case"wip":return"В процес";case"pending":return"Чакаща";case"accepted":return"Приета";case"completed":return"Завършена";case"declined":return"Отказана";case"cancelled":return"Отменена";default:return e}},C=e=>{switch(e){case"urgent":return"text-red-400";case"normal":default:return"text-slate-400";case"low":return"text-green-400"}};return j?(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,r.jsx)(d.Header,{}),(0,r.jsx)("main",{className:"container mx-auto px-4 py-8",children:(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,r.jsx)("p",{className:"mt-4 text-gray-600",children:"Зареждане на табло..."})]})}),(0,r.jsx)(n.$,{})]}):p?(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,r.jsx)(d.Header,{}),(0,r.jsx)("main",{className:"container mx-auto px-4 py-8",children:(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 text-center",children:[(0,r.jsxs)("p",{className:"text-red-800",children:["❌ ",p]}),(0,r.jsx)("button",{onClick:w,className:"mt-4 bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700",children:"Опитай отново"})]})}),(0,r.jsx)(n.$,{})]}):(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-indigo-900 relative overflow-hidden",children:[(0,r.jsxs)("div",{className:"absolute inset-0 pointer-events-none",children:[(0,r.jsx)("div",{className:"absolute top-0 left-0 w-96 h-96 bg-gradient-to-br from-indigo-500/10 to-slate-500/10 rounded-lg blur-3xl"}),(0,r.jsx)("div",{className:"absolute bottom-0 right-0 w-80 h-80 bg-gradient-to-br from-purple-500/10 to-slate-500/10 rounded-lg blur-3xl"})]}),(0,r.jsx)(d.Header,{}),(0,r.jsxs)("main",{className:"relative z-10 container mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsxs)("h1",{className:"text-3xl font-bold text-white mb-2",children:["Добре дошли, ",null==e?void 0:e.firstName,"! \uD83D\uDC4B"]}),(0,r.jsx)("p",{className:"text-slate-300",children:"Управлявайте вашите заявки и следете статистиките си"})]}),h&&(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-8",children:[(0,r.jsx)("div",{className:"bg-white/10 backdrop-blur-md rounded-xl shadow-xl border border-white/20 p-6 hover:bg-white/15 transition-all",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-blue-600 text-lg",children:"\uD83D\uDCCB"})})}),(0,r.jsxs)("div",{className:"ml-4",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-slate-300",children:"Общо заявки"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-white",children:h.totalCases})]})]})}),(0,r.jsx)("div",{className:"bg-white/10 backdrop-blur-md rounded-xl shadow-xl border border-white/20 p-6 hover:bg-white/15 transition-all",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("div",{className:"w-8 h-8 bg-green-500/20 rounded-lg flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-green-400 text-lg",children:"⚡"})})}),(0,r.jsxs)("div",{className:"ml-4",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-slate-300",children:"Активни"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-white",children:h.activeCases})]})]})}),(0,r.jsx)("div",{className:"bg-white/10 backdrop-blur-md rounded-xl shadow-xl border border-white/20 p-6 hover:bg-white/15 transition-all",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("div",{className:"w-8 h-8 bg-purple-500/20 rounded-lg flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-purple-400 text-lg",children:"✅"})})}),(0,r.jsxs)("div",{className:"ml-4",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-slate-300",children:"Завършени"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-white",children:h.completedCases})]})]})}),(0,r.jsx)("div",{className:"bg-white/10 backdrop-blur-md rounded-xl shadow-xl border border-white/20 p-6 hover:bg-white/15 transition-all",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("div",{className:"w-8 h-8 bg-yellow-500/20 rounded-lg flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-yellow-400 text-lg",children:"⭐"})})}),(0,r.jsxs)("div",{className:"ml-4",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-slate-300",children:"Оценка"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-white",children:h.averageRating.toFixed(1)})]})]})}),(0,r.jsx)("div",{className:"bg-white/10 backdrop-blur-md rounded-xl shadow-xl border border-white/20 p-6 hover:bg-white/15 transition-all",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("div",{className:"w-8 h-8 bg-orange-500/20 rounded-lg flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-orange-400 text-lg",children:"\uD83D\uDCAC"})})}),(0,r.jsxs)("div",{className:"ml-4",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-slate-300",children:"Отзиви"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-white",children:h.totalReviews})]})]})})]}),(0,r.jsxs)("div",{className:"grid gap-8 lg:grid-cols-3",children:[(0,r.jsx)("div",{className:"lg:col-span-2",children:(0,r.jsxs)("div",{className:"bg-white/10 backdrop-blur-md rounded-xl shadow-xl border border-white/20 p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-white",children:"Последни заявки"}),(0,r.jsx)("a",{href:"/dashboard?view=assigned",className:"text-indigo-400 hover:text-indigo-300 text-sm font-medium transition-colors",children:"Виж всички →"})]}),0===u.length?(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)("div",{className:"text-6xl mb-4",children:"\uD83D\uDCCB"}),(0,r.jsx)("p",{className:"text-slate-300 mb-4",children:"Няма активни заявки"}),(0,r.jsx)("p",{className:"text-sm text-slate-400",children:"Новите заявки ще се появят тук"})]}):(0,r.jsx)("div",{className:"space-y-3",children:u.map(e=>(0,r.jsxs)("div",{className:"bg-slate-800/50 border border-slate-700/50 rounded-lg p-4 hover:border-indigo-500/50 hover:bg-slate-800/70 transition-all duration-200",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsx)("h3",{className:"font-semibold text-white text-sm",children:e.title}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("span",{className:"inline-block px-2.5 py-0.5 rounded-md text-xs font-medium ".concat(y(e.status)),children:D(e.status)}),(0,r.jsx)("span",{className:"text-xs font-medium ".concat(C(e.urgency)),children:"urgent"===e.urgency?"\uD83D\uDD25":"\uD83D\uDCC5"})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between text-xs text-slate-400 mb-3",children:[(0,r.jsxs)("span",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"mr-1",children:"\uD83D\uDC64"}),e.customerName]}),(0,r.jsx)("span",{children:new Date(e.createdAt).toLocaleDateString("bg-BG")})]}),(0,r.jsxs)("div",{className:"mt-3 flex space-x-2",children:["pending"===e.status&&(0,r.jsx)("button",{onClick:()=>f(e.id),className:"bg-green-600 text-white px-3 py-1 rounded text-xs hover:bg-green-700",children:"✅ Приеми"}),("active"===e.status||"accepted"===e.status||"wip"===e.status)&&(0,r.jsx)("button",{onClick:()=>N(e.id),className:"bg-blue-600 text-white px-3 py-1 rounded text-xs hover:bg-blue-700",children:"\uD83C\uDFC1 Завърши"}),(0,r.jsx)("a",{href:"/dashboard?view=assigned",className:"bg-gray-600 text-white px-3 py-1 rounded text-xs hover:bg-gray-700 inline-block",children:"\uD83D\uDCCB Виж всички"})]})]},e.id))})]})}),(0,r.jsxs)("div",{className:"lg:col-span-1",children:[(0,r.jsxs)("div",{className:"bg-white/10 backdrop-blur-md rounded-xl shadow-xl border border-white/20 p-6 mb-6",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-white mb-4",children:"Бързи действия"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("a",{href:"/dashboard?view=assigned",className:"w-full bg-gradient-to-r from-indigo-600 to-purple-600 text-white py-2 px-4 rounded-lg hover:shadow-lg transform hover:scale-105 transition-all duration-300 text-sm font-medium flex items-center justify-center space-x-2",children:[(0,r.jsx)("span",{children:"\uD83D\uDCCB"}),(0,r.jsx)("span",{children:"Управление на заявки"})]}),(0,r.jsxs)("a",{href:"/settings?section=profile",className:"w-full bg-gradient-to-r from-green-600 to-emerald-600 text-white py-2 px-4 rounded-lg hover:shadow-lg transform hover:scale-105 transition-all duration-300 text-sm font-medium flex items-center justify-center space-x-2",children:[(0,r.jsx)("span",{children:"\uD83D\uDC64"}),(0,r.jsx)("span",{children:"Редактирай профил"})]}),(0,r.jsxs)("a",{href:"/referrals",className:"w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white py-2 px-4 rounded-lg hover:shadow-lg transform hover:scale-105 transition-all duration-300 text-sm font-medium flex items-center justify-center space-x-2",children:[(0,r.jsx)("span",{children:"\uD83E\uDD1D"}),(0,r.jsx)("span",{children:"Препоръки"})]}),(0,r.jsxs)("a",{href:"/provider/analytics",className:"w-full bg-gradient-to-r from-yellow-600 to-orange-600 text-white py-2 px-4 rounded-lg hover:shadow-lg transform hover:scale-105 transition-all duration-300 text-sm font-medium flex items-center justify-center space-x-2",children:[(0,r.jsx)("span",{children:"\uD83D\uDCCA"}),(0,r.jsx)("span",{children:"Статистики"})]})]})]}),(0,r.jsxs)("div",{className:"bg-white/10 backdrop-blur-md rounded-xl shadow-xl border border-white/20 p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"Профил"}),(0,r.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between py-2 border-b border-white/10",children:[(0,r.jsx)("span",{className:"text-slate-400",children:"Име:"}),(0,r.jsxs)("span",{className:"font-semibold text-white",children:[null==e?void 0:e.firstName," ",null==e?void 0:e.lastName]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between py-2 border-b border-white/10",children:[(0,r.jsx)("span",{className:"text-slate-400",children:"Имейл:"}),(0,r.jsx)("span",{className:"font-semibold text-white text-xs",children:null==e?void 0:e.email})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between py-2 border-b border-white/10",children:[(0,r.jsx)("span",{className:"text-slate-400",children:"Роля:"}),(0,r.jsx)("span",{className:"font-semibold text-indigo-400",children:"Доставчик на услуги"})]}),h&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between py-2 border-b border-white/10",children:[(0,r.jsx)("span",{className:"text-slate-400",children:"Оценка:"}),(0,r.jsxs)("span",{className:"font-semibold text-yellow-400",children:[h.averageRating.toFixed(1)," ⭐"]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between py-2",children:[(0,r.jsx)("span",{className:"text-slate-400",children:"Отзиви:"}),(0,r.jsx)("span",{className:"font-semibold text-white",children:h.totalReviews})]})]})]})]})]})]})]}),(0,r.jsx)(n.$,{}),(0,r.jsx)(c.default,{})]})}},2834:function(e,s,t){"use strict";t.d(s,{$:function(){return a}});var r=t(7437),l=t(7648);function a(){return(0,r.jsx)("footer",{className:"bg-slate-900 text-white",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8",children:[(0,r.jsxs)("div",{className:"col-span-1 md:col-span-2",children:[(0,r.jsxs)("div",{className:"flex items-center mb-4",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-600 to-orange-500 rounded-lg flex items-center justify-center mr-3",children:(0,r.jsx)("span",{className:"text-white font-bold text-lg",children:"\uD83D\uDD27"})}),(0,r.jsx)("span",{className:"text-xl font-bold",children:"ServiceText Pro"})]}),(0,r.jsx)("p",{className:"text-gray-400 mb-4",children:"Платформата за намиране на най-добрите професионалисти в България. Свързваме клиенти с верифицирани майстори за всички видове услуги."}),(0,r.jsxs)("div",{className:"flex space-x-4",children:[(0,r.jsxs)("a",{href:"#",className:"text-gray-400 hover:text-white",children:[(0,r.jsx)("span",{className:"sr-only",children:"Facebook"}),(0,r.jsx)("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})})]}),(0,r.jsxs)("a",{href:"#",className:"text-gray-400 hover:text-white",children:[(0,r.jsx)("span",{className:"sr-only",children:"Instagram"}),(0,r.jsx)("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{d:"M12.017 0C5.396 0 .029 5.367.029 11.987c0 6.62 5.367 11.987 11.988 11.987 6.62 0 11.987-5.367 11.987-11.987C24.014 5.367 18.637.001 12.017.001zM8.449 16.988c-1.297 0-2.448-.49-3.323-1.297C4.198 14.895 3.708 13.744 3.708 12.447s.49-2.448 1.297-3.323c.875-.807 2.026-1.297 3.323-1.297s2.448.49 3.323 1.297c.807.875 1.297 2.026 1.297 3.323s-.49 2.448-1.297 3.323c-.875.807-2.026 1.297-3.323 1.297z"})})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Услуги"}),(0,r.jsxs)("ul",{className:"space-y-2",children:[(0,r.jsx)("li",{children:(0,r.jsx)(l.default,{href:"/search?service=electrical",className:"text-gray-400 hover:text-white",children:"Електротехник"})}),(0,r.jsx)("li",{children:(0,r.jsx)(l.default,{href:"/search?service=plumbing",className:"text-gray-400 hover:text-white",children:"Водопроводчик"})}),(0,r.jsx)("li",{children:(0,r.jsx)(l.default,{href:"/search?service=hvac",className:"text-gray-400 hover:text-white",children:"Климатик"})}),(0,r.jsx)("li",{children:(0,r.jsx)(l.default,{href:"/search?service=general",className:"text-gray-400 hover:text-white",children:"Общ майстор"})})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Компания"}),(0,r.jsxs)("ul",{className:"space-y-2",children:[(0,r.jsx)("li",{children:(0,r.jsx)(l.default,{href:"/about",className:"text-gray-400 hover:text-white",children:"За нас"})}),(0,r.jsx)("li",{children:(0,r.jsx)(l.default,{href:"/how-it-works",className:"text-gray-400 hover:text-white",children:"Как работи"})}),(0,r.jsx)("li",{children:(0,r.jsx)(l.default,{href:"/contact",className:"text-gray-400 hover:text-white",children:"Контакти"})}),(0,r.jsx)("li",{children:(0,r.jsx)(l.default,{href:"/privacy",className:"text-gray-400 hover:text-white",children:"Поверителност"})})]})]})]}),(0,r.jsx)("div",{className:"border-t border-gray-800 mt-8 pt-8",children:(0,r.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center",children:[(0,r.jsx)("p",{className:"text-gray-400 text-sm",children:"\xa9 2024 ServiceText Pro. Всички права запазени."}),(0,r.jsxs)("div",{className:"flex space-x-6 mt-4 md:mt-0",children:[(0,r.jsx)(l.default,{href:"/terms",className:"text-gray-400 hover:text-white text-sm",children:"Условия за ползване"}),(0,r.jsx)(l.default,{href:"/privacy",className:"text-gray-400 hover:text-white text-sm",children:"Политика за поверителност"}),(0,r.jsx)(l.default,{href:"/gdpr",className:"text-gray-400 hover:text-white text-sm",children:"GDPR"})]})]})})]})})}}},function(e){e.O(0,[301,648,137,680,924,819,103,396,971,117,744],function(){return e(e.s=785)}),_N_E=e.O()}]);