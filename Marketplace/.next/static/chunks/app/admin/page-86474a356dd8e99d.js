(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{7112:function(e,s,t){Promise.resolve().then(t.bind(t,6683))},6683:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return c}});var l=t(7437),r=t(2265),a=t(4362),i=t(9376),d=t(3464),n=t(1819);function c(){let{user:e,isAuthenticated:s,isLoading:t}=(0,a.a)(),c=(0,i.useRouter)(),[o,m]=(0,r.useState)([]),[u,x]=(0,r.useState)(null),[h,g]=(0,r.useState)(!0),[v,p]=(0,r.useState)(null);(0,r.useEffect)(()=>{if(console.log("\uD83D\uDD0D Admin page - Auth check:",{isAuthenticated:s,user:e,isLoading:t}),t){console.log("⏳ Auth still loading, waiting...");return}if(!s){console.log("❌ Not authenticated, redirecting to login"),c.push("/auth/login");return}if(console.log("\uD83D\uDD0D User role check:",null==e?void 0:e.role),(null==e?void 0:e.role)!=="admin"){console.log("❌ Access denied. User role:",null==e?void 0:e.role),alert("❌ Access denied. Admin role required."),c.push("/");return}console.log("✅ Admin access granted"),j()},[s,e,t,c]);let j=async()=>{var e,s,t,l,r,a,i,n;try{g(!0),p(null);let a=localStorage.getItem("auth_token");if(!a){p("No authentication token found");return}console.log("\uD83D\uDCCA Loading real admin data...");let i=await d.Z.get("http://192.168.0.129:3000/api/v1/admin/security/dashboard",{headers:{Authorization:"Bearer ".concat(a)}});if(i.data.success){let a=i.data;console.log("✅ Enhanced security dashboard loaded:",a),x({totalUsers:(null===(e=a.overview)||void 0===e?void 0:e.totalThreats)||0,activeUsers:(null===(s=a.systemMetrics)||void 0===s?void 0:s.activeConnections)||0,smsBlocked:(null===(t=a.overview)||void 0===t?void 0:t.blockedThreats)||0,smsAllowed:(null===(l=a.overview)||void 0===l?void 0:l.threats24h)||0,uptime:(null===(r=a.systemMetrics)||void 0===r?void 0:r.uptime)||0}),m(a.recentThreats||[])}else{let e=await d.Z.get("http://192.168.0.129:3000/api/v1/admin/dashboard",{headers:{Authorization:"Bearer ".concat(a)}});if(e.data.success){let s=e.data.data;x(s.systemStats||{totalUsers:0,activeUsers:0,smsBlocked:0,smsAllowed:0,uptime:0}),m(s.securityAlerts||[])}}}catch(e){console.error("❌ Error loading admin data:",e),p((null===(n=e.response)||void 0===n?void 0:null===(i=n.data)||void 0===i?void 0:null===(a=i.error)||void 0===a?void 0:a.message)||e.message)}finally{g(!1)}};(0,r.useEffect)(()=>{if(!s||t)return;let e=setInterval(()=>{console.log("\uD83D\uDD04 Auto-refreshing admin data..."),j()},3e4);return()=>clearInterval(e)},[s,t]);let b=(e,s)=>{let t={id:Date.now().toString(),type:"MANUAL_TEST",severity:s,message:e,timestamp:new Date().toISOString()};m(e=>[t,...e.slice(0,9)])},y=async()=>{try{let e=localStorage.getItem("auth_token");if(!e){b("❌ No authentication token found","critical");return}console.log("\uD83E\uDDEA Testing SMS security with premium number...");let s=await d.Z.post("http://192.168.0.129:3000/api/v1/admin/security/test-sms",{phoneNumber:"0900123456",message:"Test premium number blocking"},{headers:{Authorization:"Bearer ".concat(e)}});if(s.data.success){let e=s.data.data.testResult;e.allowed?b("❌ SECURITY GAP: Premium number was NOT blocked!","critical"):(b("✅ SMS Security Working: Premium number blocked successfully!","low"),b("\uD83D\uDEE1️ Security Details: ".concat(e.reason),"low")),setTimeout(()=>{j()},1e3)}}catch(d){var e,s,t,l,r,a,i,n;console.log("\uD83E\uDDEA SMS Security Test Result:",null===(e=d.response)||void 0===e?void 0:e.data),(null===(l=d.response)||void 0===l?void 0:null===(t=l.data)||void 0===t?void 0:null===(s=t.error)||void 0===s?void 0:s.code)==="SMS_BLOCKED"||(null===(r=d.response)||void 0===r?void 0:r.status)===403?(b("✅ SMS Security Working: Premium number blocked successfully!","low"),setTimeout(()=>{j()},1e3)):b("❌ Test error: ".concat((null===(n=d.response)||void 0===n?void 0:null===(i=n.data)||void 0===i?void 0:null===(a=i.error)||void 0===a?void 0:a.message)||d.message),"medium")}};if(t)return(0,l.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto mb-4"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Loading admin panel..."})]})});let N=(null==e?void 0:e.role)==="admin";return s&&N?(0,l.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,l.jsx)(n.Header,{}),(0,l.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,l.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,l.jsxs)("div",{className:"flex justify-between items-center py-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"\uD83D\uDC51 Admin Panel"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Security & User Management"})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsx)("div",{className:"text-sm text-green-600 font-medium",children:"\uD83D\uDEE1️ System Secure"}),(0,l.jsx)("button",{onClick:()=>c.push("/"),className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700",children:"Back to App"})]})]})})}),(0,l.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[u&&(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[(0,l.jsx)("div",{className:"bg-white p-6 rounded-lg shadow",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center",children:(0,l.jsx)("span",{className:"text-white font-bold",children:"\uD83D\uDC65"})}),(0,l.jsxs)("div",{className:"ml-4",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Active Users"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:u.activeUsers})]})]})}),(0,l.jsx)("div",{className:"bg-white p-6 rounded-lg shadow",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"w-10 h-10 bg-red-500 rounded-full flex items-center justify-center",children:(0,l.jsx)("span",{className:"text-white font-bold",children:"\uD83D\uDEAB"})}),(0,l.jsxs)("div",{className:"ml-4",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"SMS Blocked"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:u.smsBlocked})]})]})}),(0,l.jsx)("div",{className:"bg-white p-6 rounded-lg shadow",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"w-10 h-10 bg-green-500 rounded-full flex items-center justify-center",children:(0,l.jsx)("span",{className:"text-white font-bold",children:"✅"})}),(0,l.jsxs)("div",{className:"ml-4",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"SMS Allowed"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:u.smsAllowed})]})]})}),(0,l.jsx)("div",{className:"bg-white p-6 rounded-lg shadow",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"w-10 h-10 bg-purple-500 rounded-full flex items-center justify-center",children:(0,l.jsx)("span",{className:"text-white font-bold",children:"\uD83D\uDD12"})}),(0,l.jsxs)("div",{className:"ml-4",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Security Level"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-green-600",children:"HIGH"})]})]})})]}),h&&!u&&(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[1,2,3,4].map(e=>(0,l.jsx)("div",{className:"bg-white p-6 rounded-lg shadow animate-pulse",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"w-10 h-10 bg-gray-300 rounded-full"}),(0,l.jsxs)("div",{className:"ml-4",children:[(0,l.jsx)("div",{className:"h-4 bg-gray-300 rounded w-20 mb-2"}),(0,l.jsx)("div",{className:"h-8 bg-gray-300 rounded w-16"})]})]})},e))}),v&&(0,l.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-8",children:(0,l.jsxs)("div",{className:"flex",children:[(0,l.jsx)("div",{className:"text-red-400",children:"⚠️"}),(0,l.jsxs)("div",{className:"ml-3",children:[(0,l.jsx)("h3",{className:"text-sm font-medium text-red-800",children:"Error Loading Data"}),(0,l.jsx)("p",{className:"text-sm text-red-700 mt-1",children:v}),(0,l.jsx)("button",{onClick:j,className:"mt-2 text-sm bg-red-100 text-red-800 px-3 py-1 rounded hover:bg-red-200",children:"Retry"})]})]})}),(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,l.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"\uD83D\uDEA8 Security Alerts"}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Real-time security monitoring"})]}),(0,l.jsx)("button",{onClick:j,className:"text-sm bg-gray-100 text-gray-700 px-3 py-1 rounded hover:bg-gray-200",children:"\uD83D\uDD04 Refresh"})]}),(0,l.jsx)("div",{className:"p-6",children:(0,l.jsx)("div",{className:"space-y-4",children:o.map(e=>(0,l.jsx)("div",{className:"p-4 rounded-lg border ".concat("critical"===e.type?"bg-red-50 border-red-200":"warning"===e.type?"bg-yellow-50 border-yellow-200":"bg-green-50 border-green-200"),children:(0,l.jsxs)("div",{className:"flex justify-between items-start",children:[(0,l.jsx)("p",{className:"font-medium",children:e.message}),(0,l.jsx)("span",{className:"text-xs text-gray-500",children:new Date(e.timestamp).toLocaleString()})]})},e.id))})})]}),(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,l.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"⚡ Admin Actions"}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"System management tools"})]}),(0,l.jsxs)("div",{className:"p-6 space-y-4",children:[(0,l.jsx)("button",{onClick:()=>b("\uD83D\uDD0D Manual security scan initiated","low"),className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 flex items-center justify-center",children:"\uD83D\uDD0D Run Security Scan"}),(0,l.jsx)("button",{onClick:()=>b("\uD83D\uDCCA System statistics updated","low"),className:"w-full bg-green-600 text-white py-3 px-4 rounded-lg hover:bg-green-700 flex items-center justify-center",children:"\uD83D\uDCCA Update Statistics"}),(0,l.jsx)("button",{onClick:()=>b("\uD83D\uDEA8 Test alert generated","medium"),className:"w-full bg-yellow-600 text-white py-3 px-4 rounded-lg hover:bg-yellow-700 flex items-center justify-center",children:"\uD83D\uDEA8 Test Alert System"}),(0,l.jsx)("button",{onClick:()=>b("\uD83D\uDEE1️ Security protocols activated","critical"),className:"w-full bg-red-600 text-white py-3 px-4 rounded-lg hover:bg-red-700 flex items-center justify-center",children:"\uD83D\uDEE1️ Emergency Protocol"}),(0,l.jsxs)("div",{className:"border-t pt-4 mt-4",children:[(0,l.jsx)("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"\uD83E\uDDEA Test SMS Security"}),(0,l.jsx)("button",{onClick:y,className:"w-full bg-purple-600 text-white py-3 px-4 rounded-lg hover:bg-purple-700 flex items-center justify-center",children:"\uD83D\uDEAB Test Premium Number Block"})]})]})]})]}),(0,l.jsxs)("div",{className:"mt-8 bg-white rounded-lg shadow",children:[(0,l.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,l.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"\uD83D\uDCBB System Information"})}),(0,l.jsx)("div",{className:"p-6",children:(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"\uD83D\uDD12 Security Status"}),(0,l.jsx)("p",{className:"text-green-600 font-medium",children:"✅ All systems secure"}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"3-layer SMS protection active"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"\uD83D\uDCF1 SMS Protection"}),(0,l.jsx)("p",{className:"text-blue-600 font-medium",children:"\uD83D\uDEE1️ Layer 1, 2, 3 Active"}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Premium numbers blocked"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"⚡ System Health"}),(0,l.jsx)("p",{className:"text-green-600 font-medium",children:"\uD83D\uDFE2 Operational"}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"All services running"})]})]})})]})]})]}):(0,l.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"text-6xl mb-4",children:"\uD83D\uDD12"}),(0,l.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Access Denied"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Admin privileges required"}),(0,l.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:s?"Current role: ".concat((null==e?void 0:e.role)||"unknown"):"Please log in first"})]})})}}},function(e){e.O(0,[301,648,137,924,819,971,117,744],function(){return e(e.s=7112)}),_N_E=e.O()}]);